{% extends "base.html" %}

{% block title %}Network Monitor - Home{% endblock %}

{% block content %}
<div class="card">
    <h1>🌐 Network Monitor Dashboard</h1>
    <p>Real-time network monitoring with automatic log rotation and garbage collection.</p>
    <p><strong>Current Date:</strong> <span id="current-date"></span></p>
    <p><strong>System Status:</strong> <span class="status-indicator status-online"></span> Online</p>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-value" id="uptime">--</div>
        <div class="stat-label">System Uptime</div>
    </div>
    <div class="stat-card">
        <div class="stat-value" id="gc-count">--</div>
        <div class="stat-label">GC Cycles</div>
    </div>
    <div class="stat-card">
        <div class="stat-value" id="log-files">6</div>
        <div class="stat-label">Active Log Files</div>
    </div>
    <div class="stat-card">
        <div class="stat-value" id="monitoring">4</div>
        <div class="stat-label">Active Monitors</div>
    </div>
</div>

<div class="card">
    <h2>📊 Available Monitoring Pages</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <h3>🏠 Internal Ping</h3>
            <p>Monitor connectivity to your router/gateway</p>
            <p><strong>Target:</strong> 10.99.0.1</p>
            <a href="/internal" class="btn">View Internal Ping</a>
        </div>
        
        <div class="stat-card">
            <h3>🌍 External Ping</h3>
            <p>Monitor internet connectivity</p>
            <p><strong>Target:</strong> 1.1.1.1</p>
            <a href="/external" class="btn">View External Ping</a>
        </div>
        
        <div class="stat-card">
            <h3>🔍 Internal Traceroute</h3>
            <p>Trace route to local gateway</p>
            <p><strong>Target:</strong> 10.99.0.1</p>
            <a href="/traceroute-internal" class="btn">View Internal Trace</a>
        </div>
        
        <div class="stat-card">
            <h3>🗺️ External Traceroute</h3>
            <p>Trace route to internet</p>
            <p><strong>Target:</strong> 1.1.1.1</p>
            <a href="/traceroute-external" class="btn">View External Trace</a>
        </div>
        
        <div class="stat-card">
            <h3>📱 Device Discovery</h3>
            <p>Monitor network devices</p>
            <p><strong>Method:</strong> ARP Scan</p>
            <a href="/devices" class="btn">View Devices</a>
        </div>
        
        <div class="stat-card">
            <h3>⚠️ Timeout Errors</h3>
            <p>External ping timeouts only</p>
            <p><strong>Source:</strong> Internet Monitor</p>
            <a href="/timeouts" class="btn">View Timeouts</a>
        </div>
        
        <div class="stat-card">
            <h3>🚀 Speed Test</h3>
            <p>Internet speed measurement</p>
            <p><strong>Test:</strong> Download/Upload/Ping</p>
            <a href="/speed-test" class="btn">Run Speed Test</a>
        </div>
        
        <div class="stat-card">
            <h3>📦 Log Downloads</h3>
            <p>Download log archives with filtering</p>
            <p><strong>Format:</strong> ZIP by date/time range</p>
            <a href="/downloads" class="btn">Download Logs</a>
        </div>
        
        <div class="stat-card">
            <h3>🌐 Network Information</h3>
            <p>Auto-detected network configuration</p>
            <p><strong>Features:</strong> Gateway, DNS, Interfaces</p>
            <a href="/network-info" class="btn">View Network Info</a>
        </div>
        
        <div class="stat-card">
            <h3>🔍 Port Scanner</h3>
            <p>Advanced port scanning with security analysis</p>
            <p><strong>Capabilities:</strong> Service detection, OS fingerprinting</p>
            <a href="/port-scanner" class="btn">Port Scanner</a>
        </div>
        
        <div class="stat-card">
            <h3>🔍 Network Discovery</h3>
            <p>Discover devices on your local network</p>
            <p><strong>Method:</strong> Advanced ping sweep + analysis</p>
            <a href="/network-discovery" class="btn">Discover Network</a>
        </div>
        
        <div class="stat-card">
            <h3>🚀 Advanced Monitoring</h3>
            <p>Comprehensive network monitoring dashboard</p>
            <p><strong>Features:</strong> Real-time analytics, alerts, controls</p>
            <a href="/advanced-monitoring" class="btn">Advanced Dashboard</a>
        </div>
    </div>
</div>

<div class="card">
    <h2>🎛️ System Controls</h2>
    <p>Manual system operations and diagnostics.</p>
    <div style="margin-top: 1rem;">
        <button onclick="runGC()" class="btn">🗑️ Run Garbage Collection</button>
        <a href="/api/logs/external_ping" class="btn" target="_blank">📄 View API Logs</a>
    </div>
</div>

<div class="card">
    <h2>📋 System Information & Features</h2>
    <div class="log-container" style="max-height: 250px;">
        <div class="log-line success">🚀 Advanced Network Monitor Web Application</div>
        <div class="log-line">📁 Log Directory: traces/ (with date-based rotation)</div>
        <div class="log-line">🔄 Log Rotation: Daily automatic + time filtering</div>
        <div class="log-line">🗑️ Garbage Collection: Every 5 minutes (memory optimized)</div>
        <div class="log-line">🌐 Web Interface: Port 5000 (cross-platform)</div>
        <div class="log-line">📡 Real-time Updates: WebSocket with live streaming</div>
        <div class="log-line">🔍 Network Auto-Detection: Gateway, DNS, Interfaces</div>
        <div class="log-line">🛡️ Port Scanning: Service detection + security analysis</div>
        <div class="log-line">📱 Device Discovery: Network topology mapping</div>
        <div class="log-line">⚡ Performance Monitoring: CPU, Memory, Network I/O</div>
        <div class="log-line">🎯 Multi-Host Monitoring: Cloudflare, Google, Quad9</div>
        <div class="log-line">🚀 Speed Testing: Multiple server selection</div>
        <div class="log-line">📊 Advanced Analytics: Real-time metrics & alerts</div>
        <div class="log-line">💾 Memory Management: Optimized for long-running</div>
        <div class="log-line success">✅ All advanced systems operational</div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    // Update current date
    document.getElementById('current-date').textContent = new Date().toLocaleDateString();
    
    // Simple uptime counter
    let startTime = Date.now();
    function updateUptime() {
        const uptime = Math.floor((Date.now() - startTime) / 1000);
        const hours = Math.floor(uptime / 3600);
        const minutes = Math.floor((uptime % 3600) / 60);
        const seconds = uptime % 60;
        document.getElementById('uptime').textContent = `${hours}h ${minutes}m ${seconds}s`;
    }
    
    setInterval(updateUptime, 1000);
    updateUptime();
    
    // Mock GC counter (would be real in production)
    let gcCount = 0;
    setInterval(() => {
        gcCount++;
        document.getElementById('gc-count').textContent = gcCount;
    }, 300000); // Every 5 minutes
</script>
{% endblock %}
